os: linux
dist: bionic

language: java

jdk:
  - openjdk8
  - openjdk11

env:
  global:
    - SCRIPT_2="./millw -i scoverage.xmlReportAll"
    - SCRIPT_3="bash scripts/codecov_upload.sh -f out/scoverage/xmlReportAll/dest/scoverage.xml"
  jobs:
    - NAME="Test Scala 2.12 (fail fast)"
      TEST_ONLINE="true"
      SCRIPT_1="travis_wait 60 ./millw -i blended[2.12.11].__.testCached"
    - NAME="Test Scala 2.13 (fail fast)"
      TEST_ONLINE="true"
      SCRIPT_1="travis_wait 60 ./millw -i blended[2.13.2].__.testCached"
    - NAME="Test (keep going)"
      TEST_ONLINE="true"
      SCRIPT_1="travis_wait 60 ./millw -i -k __.testCached"
    - NAME="Publish into local IVY repo"
      TEST_ONLINE="true"
      SCRIPT_1="travis_wait 60 ./millw -i __.publishLocal"

script:
  - "${SCRIPT_1}"
  - "${SCRIPT_2}"
  - "${SCRIPT_3}"
